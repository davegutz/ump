format short 
pow=0;
kon=1;
n_=40;
m_=40;
Im=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 1 1 1 1 1 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 1 1 1 1 1 1 1 0 0 0 0 0 0 0;
    0 0 0 0 0 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0;
    0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0;
    0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0;
    0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0;
    0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0;
    0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0;
    0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0;
    0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0;
    0 0 0 0 0 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0;
    0 0 0 0 0 0 1 1 1 1 1 1 1 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 1 1 1 1 1 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0 1 1 1 0 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0];
nnodes_=sum(sum(Im));
agauss=n_/10;
bgauss=.1;
W_=[];

for i=1:20,for j=1:20,
   W_(i,j)=0;
   if Im(i,j) > 0,
   for k=1:20,for m=1:20,
      W_(i,j) = W_(i,j) +...
             exp( -((k-i)^2+(m-j)^2) / agauss^2 ) *...
             exp( -(Im(k,m)-Im(i,j))^2  / bgauss^2  );
   end, end
   W_(i,j) = (W_(i,j)-1)*Im(i,j);
   end
end, end
Wxxl_=W_/nnodes_^pow*kon

n_=20;
m_=20;
Im=[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
    0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
    0 0 0 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
    0 0 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0;
    0 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0;
    1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0;
    0 0 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0;
    0 0 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0;
    0 0 0 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0;
    0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0];
nnodes_=sum(sum(Im));
agauss=n_/10;
bgauss=.1;
W_=[];

for i=1:n_,for j=1:m_,
   W_(i,j)=0;
   if Im(i,j) > 0,
   for k=1:n_,for m=1:m_,
      W_(i,j) = W_(i,j) +...
             exp( -((k-i)^2+(m-j)^2) / agauss^2 ) *...
             exp( -(Im(k,m)-Im(i,j))^2  / bgauss^2  );
   end, end
   W_(i,j) = (W_(i,j)-1)*Im(i,j);
   end
end, end
Wxl_=W_/nnodes_^pow*kon


n_=10;
m_=10;
Im=[0 0 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0 0 0;
    0 0 0 0 0 0 0 0 0 0;
    0 0 1 0 0 0 0 0 0 0;
    0 1 1 1 0 0 0 0 0 0;
    1 1 1 1 1 0 0 0 0 0;
    0 1 1 1 0 0 0 0 0 0;
    0 0 1 0 0 0 0 0 0 0];
nnodes_=sum(sum(Im));
agauss=n_/10;
bgauss=.1;
W_=[];

for i=1:n_,for j=1:m_,
   W_(i,j)=0;
   for k=1:n_,for m=1:m_,
      W_(i,j) = W_(i,j) +...
             exp( -((k-i)^2+(m-j)^2) / agauss^2 ) *...
             exp( -(Im(k,m)-Im(i,j))^2  / bgauss^2  );
   end, end
   W_(i,j) = (W_(i,j)-1)*Im(i,j);
end, end
Wl_=W_/nnodes_^pow*kon


n_=5;
m_=5;
Im=[ 0 0 0 0 0;
     0 0 0 0 0;
     0 1 0 0 0;
     1 1 1 0 0;
     0 1 0 0 0];
nnodes_=sum(sum(Im));
agauss=n_/10;
bgauss=.1;
W_=[];

for i=1:n_,for j=1:m_,
   W_(i,j)=0;
   for k=1:n_,for m=1:m_,
      W_(i,j) = W_(i,j) +...
             exp( -((k-i)^2+(m-j)^2) / agauss^2 ) *...
             exp( -(Im(k,m)-Im(i,j))^2  / bgauss^2  );
   end, end
   W_(i,j) = (W_(i,j)-1)*Im(i,j);
end, end
Ws_=W_/nnodes_^pow*kon









